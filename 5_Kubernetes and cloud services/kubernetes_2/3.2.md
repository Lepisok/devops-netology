# Домашнее задание к занятию «Установка Kubernetes»

### Цель задания

Установить кластер K8s.

### Чеклист готовности к домашнему заданию

1. Развёрнутые ВМ с ОС Ubuntu 20.04-lts.


### Инструменты и дополнительные материалы, которые пригодятся для выполнения задания

1. [Инструкция по установке kubeadm](https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/create-cluster-kubeadm/).
2. [Документация kubespray](https://kubespray.io/).

-----

### Задание 1. Установить кластер k8s с 1 master node

1. Подготовка работы кластера из 5 нод: 1 мастер и 4 рабочие ноды.
2. В качестве CRI — containerd.
3. Запуск etcd производить на мастере.
4. Способ установки выбрать самостоятельно.

## Дополнительные задания (со звёздочкой)

**Настоятельно рекомендуем выполнять все задания под звёздочкой.** Их выполнение поможет глубже разобраться в материале.   
Задания под звёздочкой необязательные к выполнению и не повлияют на получение зачёта по этому домашнему заданию. 

------
### Задание 2*. Установить HA кластер

1. Установить кластер в режиме HA.
2. Использовать нечётное количество Master-node.
3. Для cluster ip использовать keepalived или другой способ.

### Правила приёма работы

1. Домашняя работа оформляется в своем Git-репозитории в файле README.md. Выполненное домашнее задание пришлите ссылкой на .md-файл в вашем репозитории.
2. Файл README.md должен содержать скриншоты вывода необходимых команд `kubectl get nodes`, а также скриншоты результатов.
3. Репозиторий должен содержать тексты манифестов или ссылки на них в файле README.md.


Решение:
## Задание 1. Установить кластер k8s с 1 master node  

### Выбрать способ установки - kubeadm  
### Terrafarm скрипты для разворачивания VM  
[terraform-scripts]()

### kubectl get nodes  
``` bash
lepis@masternode:~/.kube$ kubectl get nodes
NAME          STATUS   ROLES           AGE     VERSION
masternode    Ready    control-plane   27m     v1.27.4
workernode1   Ready    <none>          3m22s   v1.27.4
workernode2   Ready    <none>          9m40s   v1.27.4
workernode3   Ready    <none>          6m51s   v1.27.4
workernode4   Ready    <none>          4m54s   v1.27.4
```
### kubectl get nodes
``` bash
NAMESPACE      NAME                                 READY   STATUS    RESTARTS      AGE
kube-flannel   kube-flannel-ds-5gt4b                1/1     Running   0             19m
kube-flannel   kube-flannel-ds-895sq                1/1     Running   0             12m
kube-flannel   kube-flannel-ds-c88hw                1/1     Running   0             9m20s
kube-flannel   kube-flannel-ds-qb5vn                1/1     Running   0             5m51s
kube-flannel   kube-flannel-ds-zvm4j                1/1     Running   0             7m23s
kube-system    coredns-5d78c9869d-gfml4             1/1     Running   0             29m
kube-system    coredns-5d78c9869d-vn44k             1/1     Running   0             29m
kube-system    etcd-masternode                      1/1     Running   0             29m
kube-system    kube-apiserver-masternode            1/1     Running   1 (29m ago)   29m
kube-system    kube-controller-manager-masternode   1/1     Running   0             29m
kube-system    kube-proxy-28ljq                     1/1     Running   0             7m23s
kube-system    kube-proxy-56sld                     1/1     Running   0             9m20s
kube-system    kube-proxy-s8v44                     1/1     Running   0             12m
kube-system    kube-proxy-xbnlg                     1/1     Running   0             29m
kube-system    kube-proxy-zscp8                     1/1     Running   0             5m51s
kube-system    kube-scheduler-masternode            1/1     Running   0             29m
```